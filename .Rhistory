# Chunk 2: libraries
#| label: libraries
if (! require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse,
sjmisc,
here,
sjlabelled,
naniar,
car,
kableExtra)
options(scipen=999)
rm(list = ls())
# Chunk 3: data
#| label: data
load(url("https://github.com/educacion-meritocracia/edumer-data/raw/main/output/data/edumer_students_long.RData"))
db_long <- edumer_students_long
rm(edumer_students_long)
glimpse(db_long)
db_long <- db_long %>%
select(id_estudiante,
ola,
consent = consentimiento,
curse_level = nivel_estudiante,
perc_effort = p1_1,
perc_talent = p1_2,
perc_rich_parents = p1_3,
perc_contact = p1_4,
pref_effort = p1_5,
pref_talent = p1_6,
pref_rich_parents = p1_7,
pref_contact = p1_8,
school_effort = p2_1,
school_talent = p2_2,
inequality = p9_1,
just_educ = p9_3,
just_health = p9_4,
just_pension = p9_5,
gender = p20,
age = p21_ano,
educ_m = p26,
educ_p = p27,
books = p30)
db_long <- db_long %>% filter(consent == 1) %>% select(-consent)
# recode and transform ----
# level
frq(db_long$curse_level)
db_long <- db_long %>%
mutate(
cohort_level = if_else(curse_level %in% c("6to", "7mo"), "Básica", "Media"),
cohort_level = factor(cohort_level,
levels = 1:2,
labels = c("Básica", "Media")),
curse_level = factor(curse_level,
levels = 1:4,
labels = c("6to", "7mo", "1ro", "2do"))
)
# level
frq(db_long$curse_level)
db_long <- db_long %>%
mutate(
cohort_level = if_else(curse_level %in% c("6to", "7mo"), "Básica", "Media"),
cohort_level = factor(cohort_level,
labels = c("Básica", "Media")),
curse_level = factor(curse_level,
levels = c("6to", "7mo", "1ro", "2do"))
)
# Chunk 1: set
#| label: set
#| echo: false
#| message: false
#| warning: false
library(knitr)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)
table_format <- if(is_html_output()) {
"html"
} else if(is_latex_output()) {
"latex"
}
table_format2 <- if(is_html_output()) {
T
} else if(is_latex_output()) {
F
}
options(kableExtra.html.bsTable = T)
options(knitr.kable.NA = "")
# Chunk 2: libraries
#| label: libraries
if (! require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse,
sjmisc,
here,
sjlabelled,
naniar,
car,
kableExtra)
options(scipen=999)
rm(list = ls())
# Chunk 3: data
#| label: data
load(url("https://github.com/educacion-meritocracia/edumer-data/raw/main/output/data/edumer_students_long.RData"))
db_long <- edumer_students_long
rm(edumer_students_long)
glimpse(db_long)
db_long <- db_long %>%
select(id_estudiante,
ola,
consent = consentimiento,
curse_level = nivel_estudiante,
perc_effort = p1_1,
perc_talent = p1_2,
perc_rich_parents = p1_3,
perc_contact = p1_4,
pref_effort = p1_5,
pref_talent = p1_6,
pref_rich_parents = p1_7,
pref_contact = p1_8,
school_effort = p2_1,
school_talent = p2_2,
inequality = p9_1,
just_educ = p9_3,
just_health = p9_4,
just_pension = p9_5,
gender = p20,
age = p21_ano,
educ_m = p26,
educ_p = p27,
books = p30)
db_long <- db_long %>% filter(consent == 1) %>% select(-consent)
# level
frq(db_long$curse_level)
db_long <- db_long %>%
mutate(
cohort_level = if_else(curse_level %in% c("6to", "7mo"), "Básica", "Media"),
cohort_level = factor(cohort_level,
labels = c("Básica", "Media")),
curse_level = factor(curse_level,
levels = c("6to", "7mo", "1ro", "2do"))
)
# level
frq(db_long$curse_level)
frq(db_long$perc_effort)
frq(db_long$perc_talent)
frq(db_long$perc_rich_parents)
frq(db_long$perc_contact)
frq(db_long$pref_effort)
frq(db_long$pref_talent)
frq(db_long$pref_rich_parents)
frq(db_long$pref_contact)
labels1 <- c("Muy en desacuerdo" = 1,
"En desacuerdo" = 2,
"De acuerdo" = 3,
"Muy de acuerdo" = 4,
"No sabe" = 88,
"No responde" = 99)
db_long <- db_long %>%
mutate_at(.vars = (4:11),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (4:11),.funs = ~ set_na(., na = c(88,99)))
# merit school
frq(db_long$school_effort)
frq(db_long$school_talent)
db_long <- db_long %>%
mutate_at(.vars = (12:13),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (12:13),.funs = ~ set_na(., na = c(88,99)))
# percp inequality
frq(db_long$inequality)
db_long <- db_long %>%
mutate(inequality = sjlabelled::set_labels(inequality, labels = labels1),
inequality = set_na(inequality, na = c(88,99)))
# market justice preference
frq(db_long$just_educ)
frq(db_long$just_health)
frq(db_long$just_pension)
db_long <- db_long %>%
mutate_at(.vars = (15:17),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (15:17),.funs = ~ set_na(., na = c(88,99)))
db_long$mjp <- rowMeans(x = db_long[15:17], na.rm = T)
db_long$mjp <- if_else(is.nan(db_long$mjp), NA, db_long$mjp)
summary(db_long$mjp)
# gender
frq(db_long$gender)
db_long$gender <- car::recode(db_long$gender,
recodes = c("'H'= 'Hombre'; 'M' = 'Mujer'; 'O' = 'Otro'"),
as.factor = T)
# age
frq(db_long$age)
db_long$age <- 2024 - db_long$age
db_long$age2 <- db_long$age^2
# ses
frq(db_long$books)
db_long <- db_long %>%
mutate(books = case_when(books <= 2 ~ "Menos de 25",
books >= 3 & books <= 6 ~ "Más de 25",
TRUE ~ NA_character_),
books = factor(books, levels = 1:2, labels = c("Menos de 25", "Más de 25")))
# ses
frq(db_long$books)
# Chunk 1: set
#| label: set
#| echo: false
#| message: false
#| warning: false
library(knitr)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)
table_format <- if(is_html_output()) {
"html"
} else if(is_latex_output()) {
"latex"
}
table_format2 <- if(is_html_output()) {
T
} else if(is_latex_output()) {
F
}
options(kableExtra.html.bsTable = T)
options(knitr.kable.NA = "")
# Chunk 2: libraries
#| label: libraries
if (! require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse,
sjmisc,
here,
sjlabelled,
naniar,
car,
kableExtra)
options(scipen=999)
rm(list = ls())
# Chunk 3: data
#| label: data
load(url("https://github.com/educacion-meritocracia/edumer-data/raw/main/output/data/edumer_students_long.RData"))
db_long <- edumer_students_long
rm(edumer_students_long)
glimpse(db_long)
#| label: processing
# select ----
db_long <- db_long %>%
select(id_estudiante,
ola,
consent = consentimiento,
curse_level = nivel_estudiante,
perc_effort = p1_1,
perc_talent = p1_2,
perc_rich_parents = p1_3,
perc_contact = p1_4,
pref_effort = p1_5,
pref_talent = p1_6,
pref_rich_parents = p1_7,
pref_contact = p1_8,
school_effort = p2_1,
school_talent = p2_2,
inequality = p9_1,
just_educ = p9_3,
just_health = p9_4,
just_pension = p9_5,
gender = p20,
age = p21_ano,
educ_m = p26,
educ_p = p27,
books = p30)
# filter ----
db_long <- db_long %>% filter(consent == 1) %>% select(-consent)
# recode and transform ----
# level
frq(db_long$curse_level)
db_long <- db_long %>%
mutate(
cohort_level = if_else(curse_level %in% c("6to", "7mo"), "Básica", "Media"),
cohort_level = factor(cohort_level,
labels = c("Básica", "Media")),
curse_level = factor(curse_level,
levels = c("6to", "7mo", "1ro", "2do"))
)
# merit-scale society
frq(db_long$perc_effort)
frq(db_long$perc_talent)
frq(db_long$perc_rich_parents)
frq(db_long$perc_contact)
frq(db_long$pref_effort)
frq(db_long$pref_talent)
frq(db_long$pref_rich_parents)
frq(db_long$pref_contact)
labels1 <- c("Muy en desacuerdo" = 1,
"En desacuerdo" = 2,
"De acuerdo" = 3,
"Muy de acuerdo" = 4,
"No sabe" = 88,
"No responde" = 99)
db_long <- db_long %>%
mutate_at(.vars = (4:11),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (4:11),.funs = ~ set_na(., na = c(88,99)))
# merit school
frq(db_long$school_effort)
frq(db_long$school_talent)
db_long <- db_long %>%
mutate_at(.vars = (12:13),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (12:13),.funs = ~ set_na(., na = c(88,99)))
# percp inequality
frq(db_long$inequality)
db_long <- db_long %>%
mutate(inequality = sjlabelled::set_labels(inequality, labels = labels1),
inequality = set_na(inequality, na = c(88,99)))
# market justice preference
frq(db_long$just_educ)
frq(db_long$just_health)
frq(db_long$just_pension)
db_long <- db_long %>%
mutate_at(.vars = (15:17),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (15:17),.funs = ~ set_na(., na = c(88,99)))
db_long$mjp <- rowMeans(x = db_long[15:17], na.rm = T)
db_long$mjp <- if_else(is.nan(db_long$mjp), NA, db_long$mjp)
summary(db_long$mjp)
# gender
frq(db_long$gender)
db_long$gender <- car::recode(db_long$gender,
recodes = c("'H'= 'Hombre'; 'M' = 'Mujer'; 'O' = 'Otro'"),
as.factor = T)
# age
frq(db_long$age)
db_long$age <- 2024 - db_long$age
db_long$age2 <- db_long$age^2
# ses
frq(db_long$books)
db_long <- db_long %>%
mutate(books = case_when(books <= 2 ~ "Menos de 25",
books >= 3 & books <= 6 ~ "Más de 25",
TRUE ~ NA_character_),
books = factor(books, levels = c("Menos de 25", "Más de 25")))
# ses
frq(db_long$books)
frq(db_long$educ_m)
frq(db_long$educ_p)
db_long <- db_long %>%
mutate(
across(
.cols = c(educ_m, educ_p),
.fns = ~ set_na(., na = c(88,99))
)
)
frq(db_long$educ_p)
frq(db_long$educ_m)
db_long %>%
group_by(id_estudiante, ola) %>%
select(educ_p, educ_m)
# Chunk 1: set
#| label: set
#| echo: false
#| message: false
#| warning: false
library(knitr)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)
table_format <- if(is_html_output()) {
"html"
} else if(is_latex_output()) {
"latex"
}
table_format2 <- if(is_html_output()) {
T
} else if(is_latex_output()) {
F
}
options(kableExtra.html.bsTable = T)
options(knitr.kable.NA = "")
# Chunk 2: libraries
#| label: libraries
if (! require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse,
sjmisc,
here,
sjlabelled,
naniar,
car,
kableExtra)
options(scipen=999)
rm(list = ls())
# Chunk 3: data
#| label: data
load(url("https://github.com/educacion-meritocracia/edumer-data/raw/main/output/data/edumer_students_long.RData"))
db_long <- edumer_students_long
rm(edumer_students_long)
glimpse(db_long)
# Chunk 4: select
#| label: select
db_long <- db_long %>%
select(id_estudiante,
ola,
consent = consentimiento,
curse_level = nivel_estudiante,
perc_effort = p1_1,
perc_talent = p1_2,
perc_rich_parents = p1_3,
perc_contact = p1_4,
pref_effort = p1_5,
pref_talent = p1_6,
pref_rich_parents = p1_7,
pref_contact = p1_8,
school_effort = p2_1,
school_talent = p2_2,
inequality = p9_1,
just_educ = p9_3,
just_health = p9_4,
just_pension = p9_5,
gender = p20,
age = p21_ano,
educ_m = p26,
educ_p = p27,
books = p30)
# Chunk 5: filter
#| label: filter
db_long <- db_long %>% filter(consent == 1) %>% select(-consent)
# Chunk 6: recode and transform
#| label: recode and transform
# level
frq(db_long$curse_level)
db_long <- db_long %>%
mutate(
cohort_level = if_else(curse_level %in% c("6to", "7mo"), "Básica", "Media"),
cohort_level = factor(cohort_level,
labels = c("Básica", "Media")),
curse_level = factor(curse_level,
levels = c("6to", "7mo", "1ro", "2do"))
)
# merit-scale society
frq(db_long$perc_effort)
frq(db_long$perc_talent)
frq(db_long$perc_rich_parents)
frq(db_long$perc_contact)
frq(db_long$pref_effort)
frq(db_long$pref_talent)
frq(db_long$pref_rich_parents)
frq(db_long$pref_contact)
labels1 <- c("Muy en desacuerdo" = 1,
"En desacuerdo" = 2,
"De acuerdo" = 3,
"Muy de acuerdo" = 4,
"No sabe" = 88,
"No responde" = 99)
db_long <- db_long %>%
mutate_at(.vars = (4:11),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (4:11),.funs = ~ set_na(., na = c(88,99)))
# merit school
frq(db_long$school_effort)
frq(db_long$school_talent)
db_long <- db_long %>%
mutate_at(.vars = (12:13),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (12:13),.funs = ~ set_na(., na = c(88,99)))
# percp inequality
frq(db_long$inequality)
db_long <- db_long %>%
mutate(inequality = sjlabelled::set_labels(inequality, labels = labels1),
inequality = set_na(inequality, na = c(88,99)))
# market justice preference
frq(db_long$just_educ)
frq(db_long$just_health)
frq(db_long$just_pension)
db_long <- db_long %>%
mutate_at(.vars = (15:17),.funs = ~ sjlabelled::set_labels(., labels = labels1))
db_long <- db_long %>%
mutate_at(.vars = (15:17),.funs = ~ set_na(., na = c(88,99)))
db_long$mjp <- rowMeans(x = db_long[15:17], na.rm = T)
db_long$mjp <- if_else(is.nan(db_long$mjp), NA, db_long$mjp)
summary(db_long$mjp)
# gender
frq(db_long$gender)
db_long$gender <- car::recode(db_long$gender,
recodes = c("'H'= 'Hombre'; 'M' = 'Mujer'; 'O' = 'Otro'"),
as.factor = T)
# age
frq(db_long$age)
db_long$age <- 2024 - db_long$age
db_long$age2 <- db_long$age^2
# ses
frq(db_long$books)
db_long <- db_long %>%
mutate(books = case_when(books <= 2 ~ "Menos de 25",
books >= 3 & books <= 6 ~ "Más de 25",
TRUE ~ NA_character_),
books = factor(books, levels = c("Menos de 25", "Más de 25")))
frq(db_long$educ_m)
frq(db_long$educ_p)
db_long <- db_long %>%
mutate(
across(
.cols = c(educ_m, educ_p),
.fns = ~ set_na(., na = c(88,99))
)
)
db_long %>%
group_by(id_estudiante, ola) %>%
select(educ_p, educ_m) # ver como crearon esta variable en el paper mdpi
# Chunk 7: missings
#| label: missings
colSums(is.na(db_long))
na.omit(db_long)
any_na(db_long)
n_miss(db_long)
prop_miss(db_long[c(4:14)])
naniar::gg_miss_var(db_long)
miss_var_summary(db_long)
miss_var_table(db_long)
miss_case_summary(db_long)
miss_case_table(db_long)
vis_miss(db_long) + theme(axis.text.x = element_text(angle=80))
# Chunk 8
#print(summarytools::dfSummary(data), method="render")
